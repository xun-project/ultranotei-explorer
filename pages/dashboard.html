<div class="slim-mainpanel">
  <div class="container pd-t-30">

    <div class="dash-headline-two" id="welcomeSection">
      <div>
        <h4 class="tx-white mg-b-5 font-weight-600 font-size-2em" tkey="dashboard">Dashboard</h4>
        <p class="mg-b-0" id="currentDate"></p>
      </div>
    </div><!-- dash-headline-two -->
    <div class="row justify-content-center mb-5 pt-5">
      <div class="col-xl-3 col-sm-6 m-t35">
        <div class="card height-10em border-radius20px">
          <div class="card-body text-center">
            <img src="../img/bank.png" class="margin-top-65px height-icon-width" alt="not found"/>
            <h6 class="text-white">Total Banked <span id="depositCoinsPct"></span></h6>
            <h6 class="text-white mt-3">Total funds locked in deposits.</h6>
            <h6 class="text-white"><span id="depositCoins">N/A</h6></h6>
            <br/>
            <!-- <h6 class="text-white">Current block reward</h6> -->
          </div>
        </div>
      </div>
      <div class="col-xl-3 col-sm-6 m-t35">
        <div class="card height-10em border-radius20px">
          <div class="card-body text-center">
            <img src="../img/circulating.png" class="margin-top-65px height-icon-width" alt="not found"/>
            <h6 class="text-white mt-0">Circulating Supply <span id="emissionPercentPct"></span></h6>
            <h6 class="text-white mt-3" tkey="circulatingSuppyInfo">The total number of coins not banked.</label>
            <h6 class="text-white"><span id="emissionPercent">N/A</span></h6>
            <br/>
          </div>
        </div>
      </div>
      <div class="col-xl-3 col-sm-6 m-t35">
        <div class="card height-10em border-radius20px">
          <div class="card-body text-center">
            <img src="../img/supply-chain.png" class="margin-top-65px height-icon-width" alt="not found"/>
            <h6 class="text-white mt-0" tkey="totalSupply">Total Supply <span class="text-white mt-3" id="totalCoinsPct">(100%)</span></h6>
            <h6 class="text-white mt-3" tkey="totalSupplyInfo">The total supply minted to date.</label>
            <h6 class="text-white"><span id="totalCoins">N/A</span></h6>
            <br/>
          </div>
        </div>
      </div>
    </div><!-- row -->
    <hr>
    <div class="nav-statistics-wrapper">
      <nav class="nav">
        <a href="" class="nav-link font-weight-600 font-size-2em txt-white" style="color:white !important; text-underline: none;" tkey="overview">Overview</a>
      </nav>
    </div><!-- nav-statistics-wrapper -->


    <div class="row no-gutters row-statistics mg-b-30" id="networkDiffRow">
      <div class="dasboard-box">
        <h1 class="tx-white tx-56 tx-lato tx-bold"><span id="networkDifficulty">N/A</span></h1>
        <h6 class="tx-15 tx-primary tx-bold mg-b-20" tkey="netDifficulty">Network Difficulty</h6>
        <p tkey="netDiffInfo">Chart on the right show the network difficulty for the last 30 blocks.</p>
        <a data-page="explorer.html" href="#explorer" class="statement-link btn-secondary" style=" background-color: #6418C3;
        border-color: #6418C3; color:white !important;" tkey="netExplorer">Network Explorer<i
            class="fa fa-angle-right mg-l-5"></i></a>
        <p class="tx-12"></p>
      </div><!-- col-5 -->
      <div class="dasboard-box">
        <canvas id="diffAreaChart" height="280"></canvas>
      </div><!-- col-7 -->
    </div><!-- row -->

    <hr>

    <div class="report-summary-header">
      <div>
        <h4 class="tx-white mg-b-3 font-size-2em" tkey="netOverallSummary">Overall Network Summary</h4>
      </div>
      <div>
        <a href="https://ultranote.org/#about" class="btn" style=" background-color: #6418C3;
        border-color: #6418C3; color:white !important;" tkey="aboutUltraNoteNetwork">About
          UltraNote Network</a>
      </div>
    </div><!-- d-flex -->

      <div class="row input-bg-purple-dark justify-content-center mt-5 pt-5 pb-5">
        <div class="col-xl-3 col-sm-6 m-t35">
          <div class="card height-10em border-radius20px">
            <div class="card-body text-center">
              <img src="../img/blockchain.png" class="margin-top-65px height-icon-width" alt="not found"/>
              <h2 id="networkHeight" class="text-white font-weight-600">N/A</h2>
              <br/>
              <h6 class="text-white">Blockchain Height</h6>
            </div>
  
          </div>
  
        </div>
        <div class="col-xl-3 col-sm-6 m-t35">
          <div class="card height-10em border-radius20px">
            <div class="card-body text-center">
              <img src="../img/lending.png" class="margin-top-65px height-icon-width" alt="not found"/>
              <h2 id="networkTransactions" class="text-white font-weight-600">N/A</h2>
              <br/>
              <h6 class="text-white">Transactions</h6>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-sm-6 m-t35">
          <div class="card height-10em border-radius20px">
            <div class="card-body text-center">
              <img src="../img/networking.png" class="margin-top-65px height-icon-width" alt="not found"/>
              <h2 id="networkHashrate" class="text-white font-weight-600">N/A</h2>
              <br/>
              <h6 class="text-white">Network Hashrate</h6>
            </div>
  
          </div>
  
        </div>
      </div><!-- row -->
      <hr>
    <div class="report-summary-header">
      <div>
        <h4 class="tx-white mg-b-3 font-size-2em" tkey="miningInfo">Mining info</h4>
      </div>
    </div><!-- d-flex -->
    

      <div class="row justify-content-center mt-5 pt-5 pb-5">
        <div class="col-xl-3 col-sm-6 m-t35">
          <div class="card height-10em border-radius20px">
            <div class="card-body text-center">
              <img src="../img/medal.png" class="margin-top-65px height-icon-width" alt="not found"/>
              <h2 id="currentReward" class="text-white font-weight-600">N/A</h2>
              <br/>
              <h6 class="text-white">Current block reward</h6>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-sm-6 m-t35">
          <div class="card height-10em border-radius20px">
            <div class="card-body text-center">
              <img src="../img/miner.png" class="margin-top-65px height-icon-width" alt="not found"/>
              <h2 id="numOfMiners" class="text-white font-weight-600">N/A</h2>
              <br/>
              <h6 class="text-white">Number of Miners</h6>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-sm-6 m-t35">
          <div class="card height-10em border-radius20px">
            <div class="card-body text-center">
              <img src="../img/time.png" class="margin-top-65px height-icon-width" alt="not found"/>
              <h2 id="sumPoolsHashrate" class="text-white font-weight-600">N/A</h2>
              <br/>
              <h6 class="text-white">Pools Speed</h6>
            </div>
          </div>
        </div>
      </div><!-- row -->

    <!-- <div class="nav-statistics-wrapper mg-t-20">
      <nav class="nav">
        <a href="" class="nav-link active" tkey="markets">Market / Calculator</a>
      </nav>
    </div>nav-statistics-wrapper -->

    <!-- Statistics -->
    <!-- <div id="blockStats" class="card card-dash-one mg-b-20">
      <div class="row no-gutters">
        <div class="col-lg-3">
          <div class="dash-content dash-small-info dash-market">
            <div class="info-text">
              <label class="tx-primary" tkey="mktXUNIToUSD">XUNI to USD</label>
              <h2><span id="XUNIToUSD">N/A</h2>
            </div>
            <div class="icon icon-info">
              <span class="fa fa-sm fa-dollar"></span>
            </div>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="dash-content dash-small-info dash-market">
            <div class="info-text">
              <label class="tx-primary" tkey="mktXUNIToBTC">XUNI to BTC</label>
              <h2><span id="XUNIToBTC">N/A</span></h2>
            </div>
            <div class="icon icon-info">
              <span class="fa fa-sm fa-btc"></span>
            </div>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="dash-content dash-small-info dash-market">
            <div class="info-text">
              <label class="tx-primary" tkey="mktMarketcap">Marketcap</label><label class="tx-primary"
                id="marketcapRank"></label>
              <h2><span id="marketcap">N/A</span></h2>
            </div>
            <div class="icon icon-info">
              <span class="fa fa-sm fa-trophy"></span>
            </div>
          </div>
        </div>
        <div class="col-lg-3">
          <div class="dash-content dash-small-info dash-market">
            <div class="info-text">
              <label class="tx-primary" tkey="mktDailyVolume">Daily Volume</label>
              <h2><span id="dailyVolume">N/A</span></h2>
            </div>
            <div class="icon icon-info">
              <span class="fa fa-sm fa-money"></span>
            </div>
          </div>
        </div>
      </div>
    </div> -->
<!-- 
    <div id="chartMarketPrice">
      <canvas id="chartMarketPriceCanvas"></canvas>
      <a class="chart-style"></a>
    </div> -->
    <hr>
    <div class="report-summary-header">
      <div>
        <h4 class="tx-white mg-b-3 font-size-2em" tkey="miningInfo">Market / Calculator</h4>
      </div>
    </div><!-- d-flex -->

    <div class="row justify-content-center mt-5 pt-5 mb-5">
      <div class="col-xl-3 col-sm-6 m-t35">
        <div class="card height-10em border-radius20px">
          <div class="card-body text-center">
            <img src="../img/dollars.png" class="margin-top-65px height-icon-width" alt="not found"/>
            <h2 id="XUNIToUSD" class="text-white font-weight-600">$168,331.09</h2>
            <br/>
            <h6 class="text-white">XUNI TO USD</h6>
          </div>

        </div>

      </div>
      <div class="col-xl-3 col-sm-6 m-t35">
        <div class="card height-10em border-radius20px">
          <div class="card-body text-center">
            <img src="../img/xuni.png" class="margin-top-65px height-icon-width" alt="not found"/>
            <h2 id="XUNIToBTC" class="text-white font-weight-600">$168,331.09</h2>
            <br/>
            <h6 class="text-white">XUNI TO BTC</h6>
          </div>

        </div>

      </div>
      <div class="col-xl-3 col-sm-6 m-t35">
        <div class="card height-10em border-radius20px">
          <div class="card-body text-center">
            <img src="../img/market-cap.png" class="margin-top-65px height-icon-width" alt="not found"/>
            <h2 class="text-white font-weight-600">N/A</h2>
            <br/>
            <h6 class="text-white">Market Cap</h6>
          </div>

        </div>

      </div>
      <div class="col-xl-3 col-sm-6 m-t35">
        <div class="card height-10em border-radius20px">
          <div class="card-body text-center">
            <img src="../img/volume.png" class="margin-top-65px height-icon-width" alt="not found"/>
            <h2 class="text-white font-weight-600">N/A</h2>
            <br/>
            <h6 class="text-white">Daily Volume</h6>
          </div>

        </div>

      </div>
    </div>

    <!-- Mining Profit Calculator -->
    <div class="card mg-t-20" id="miningProfitCalc">
      <div class="card-header tx-medium bd-0 tx-white bg-purple-dark text-center"><span tkey="estimateProfit">Estimate Mining
          Profits</span></div>
      <div class="card-body text-center m-auto" id="calcHashHolder">
        <div class="input-group">
          <input class="form-control input-bg-purple-dark" id="calcHashRate" tplaceholder="enterYourHashrate"
            placeholder="Enter Your Hash Rate" type="number">
          <div class="input-group-btn">
            <button type="button" class="btn btn-primary dropdown-toggle input-bg-purple-dark" data-toggle="dropdown" id="calcHashDropdown">
              <span id="calcHashUnit" class="text-white" data-mul="1">KH/s</span> <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" role="menu" id="calcHashUnits">
              <li><a href="#" data-mul="0">H/s</a></li>
              <li><a href="#" data-mul="1">KH/s</a></li>
              <li><a href="#" data-mul="2">MH/s</a></li>
            </ul>
          </div>
          <span class="input-group-addon input-bg-purple-dark">=</span>
          <span class="input-group-addon input-bg-purple-dark" id="calcHashResultsHolder">
            <div id="calcHashAmount">
              <span id="calcHashAmount1"></span>
              <span id="calcHashSymbol"> XUNI</span>
              <span id="calcHashAmount2"></span>
            </div>
            <div id="calcHashPeriod" class="input-bg-purple-dark">
              <span tkey="perDay">per day</span>
            </div>
          </span>
        </div>
      </div>
    </div>

  </div><!-- container -->
</div><!-- slim-mainpanel -->

<script>
  var block = null;
  var USDperXUNI = null;
  var diffAreaChart = null;
  var marketPriceAreaChart = null;


  // Automatically update profit calculation on key press
  $('#calcHashRate').keyup(calcEstimateProfit).change(calcEstimateProfit);

  // Click on button
  $('#calcHashUnits > li > a').click(function (e) {
    e.preventDefault();
    $('#calcHashUnit').text($(this).text()).data('mul', $(this).data('mul'));
    calcEstimateProfit();
  });

  function initializePoolData() {
    $.getJSON(poolListUrl, function (data, textStatus, jqXHR) {
      var totalHashrate = 0;
      var totalMiners = 0;

      data.forEach(function (element) {
        totalHashrate += element.pool.hashrate;
        totalMiners += element.pool.miners;
      });

      updateText('sumPoolsHashrate', getReadableHashRateString(totalHashrate));
      updateText('numOfMiners', localizeNumber(totalMiners));
    });

    getXUNIdata()
  }

  async function getXUNIdata() {
    //var currencies = ["USD", "EUR", "BTC", "LTC", "ETH"]
    var currencies = ["USD", "BTC"]
    for (var item of currencies) {
      var data = await getprice(item)
      if (data) {
        data = data[0]
        $(`#XUNITo${item}`).text(parseFloat(data.price).toFixed(8))
      }
    }
  }

  function getprice(item) {
    return new Promise(function (resolve, reject) {
      $.getJSON(`https://api.allorigins.win/get?url=${encodeURIComponent(`https://api.nomics.com/v1/currencies/ticker?key=507809c103093e0c58f74648d03644c2d0c0ade4&ids=XUNI&interval=1d,30d&convert=${item}&per-page=100&page=1`)}`, function (data, textStatus, jqXHR) {
        setTimeout(() => {

          resolve(JSON.parse(data.contents))
        }, 1000)
      })
    })
  }


  // Calculate current estimation
  function calcEstimateProfit() {
    try {
      var rateUnit = Math.pow(1000, parseInt($('#calcHashUnit').data('mul')));
      var hashRate = parseFloat($('#calcHashRate').val()) * rateUnit;
      var profit = (hashRate * 86400 / lastStats.difficulty) * lastStats.last_block_reward;
      if (profit) {
        var actualCoins = getReadableCoins(profit, 2, true);
        updateText('calcHashAmount1', actualCoins);
        updateText('calcHashAmount2', getCurrencyPriceText(actualCoins));
        return;
      }
    }
    catch (e) { }
    updateText('calcHashAmount1', '');
    updateText('calcHashAmount2', '');
  }

  // Get price in specified currency
  function getCurrencyPriceText(coinAmmount) {
    if (USDperXUN) {
      var price = USDperXUN * coinAmmount;
      return ("($ " + price.toFixed(2) + ")");
    }
  }

  currentPage = {
    destroy: function () {
    },
    init: function () {
      $("#currentDate").html("Today is: " + moment().format('MMMM Do YYYY'));
      initializePoolData();
      loadTranslations();

      $.ajax({
        url: api + '/json_rpc',
        method: "POST",
        data: JSON.stringify({
          jsonrpc: "2.0",
          id: "test",
          method: "f_blocks_list_json",
          params: {
            height: lastStats.last_known_block_index
          }
        }),
        dataType: 'json',
        cache: 'false',
        success: function (data) {
          renderDiffChart(data.result.blocks);
        }
      });


    },
    update: function () {
      renderLastBlock();

      updateText('networkHeight', localizeNumber(lastStats.height.toString()));
      updateText('networkTransactions', localizeNumber(lastStats.tx_count.toString()));
      updateText('networkHashrate', getReadableHashRateString(lastStats.difficulty / blockTargetInterval));
      updateText('networkDifficulty', getReadableDifficultyString(lastStats.difficulty, 0));
      $("time.timeago").timeago();
    }
  };

  function renderLastBlock() {
    $.getJSON("https://stats.ultranote.org/daemon/getinfo", function (infoData) {
      updateText('totalBanked', getReadableCoins2(infoData.full_deposit_amount, 0));

      $.ajax({
        url: api + '/json_rpc',
        method: "POST",
        data: JSON.stringify({
          jsonrpc: "2.0",
          id: "test",
          method: "getlastblockheader",
          params: {}
        }),
        dataType: 'json',
        cache: 'false',
        success: function (data) {
          last_block_hash = data.result.block_header.hash;
          last_block_deposts = data.result.block_header.deposits;
          $.ajax({
            url: api + '/json_rpc',
            method: "POST",
            data: JSON.stringify({
              jsonrpc: "2.0",
              id: "test",
              method: "f_block_json",
              params: {
                hash: last_block_hash
              }
            }),
            dataType: 'json',
            cache: 'false',
            success: function (data) {
              var block = data.result.block;
              var circulating_supply = block.alreadyGeneratedCoins - last_block_deposts;
              var circulating_supply_pct = ((circulating_supply / block.alreadyGeneratedCoins) * 100).toFixed(2);
              var last_block_deposts_pct = ((last_block_deposts / block.alreadyGeneratedCoins) * 100).toFixed(2);
              updateText('totalCoins', getReadableCoins2(block.alreadyGeneratedCoins, 0));
              updateText('emissionPercent', getReadableCoins2(circulating_supply, 0));
              updateText('emissionPercentPct', "(" + circulating_supply_pct + "%)");
              updateText('currentReward', getReadableCoins(block.baseReward, 2));
              updateText('depositCoins', getReadableCoins2(last_block_deposts, 0));
              updateText('depositCoinsPct', "(" + last_block_deposts_pct + "%)");

            }
          });
        }
      });
    });
  }

  function renderDiffChart(blocksData) {
    var diffData = [];
    var labelData = [];

    for (i = 0; i < blocksData.length; i++) {
      diffData.push(blocksData[i].difficulty);
      labelData.push(moment.unix(blocksData[i].timestamp).format("hh:mm:ss"));
    }

    if (diffAreaChart) {
      diffAreaChart.destroy();
    }

    diffAreaChart = new Chart(document.getElementById('diffAreaChart'), {
      type: 'bar',
      data: {
        labels: labelData,
        datasets: [{
          data: smooth(diffData, 2),
          backgroundColor: 'rgba(255,165,1,1)',
          fill: true,
          borderWidth: 0,
          borderColor: '#FFA500'
        }]
      },
      options: {
        maintainAspectRatio: false,
        legend: {
          display: false,
          labels: {
            display: false
          }
        },
        scales: {
          yAxes: [{
            ticks: {
              maxTicksLimit: 5,
              beginAtZero: true,
              fontSize: 10
            },
            gridLines: {
            }
          }],
          xAxes: [{
            ticks: {
              beginAtZero: true,
              fontSize: 11
            },
            gridLines: {
            }
          }]
        }
      }
    });
  }
</script>
9:16 PM 3/2/2022